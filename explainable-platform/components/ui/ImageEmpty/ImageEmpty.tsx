import { useEffect, useState } from "react";
import { ShapLabel } from "../ShapLabel/ShapLabel";
import { isNull } from "lodash";

export const ShapPlotPlaceholder = (props: {
  src?: string;
  plotName?: string;
  showShapLabel?: boolean;
}) => {
  const [isError, setIsError] = useState(false);

  useEffect(() => {
    setIsError(isNull(props.src));
  }, [props]);

  return (
    <>
      {isError ? (
        <div className="bg-gray-50 text-gray-500 px-4 py-2 rounded-lg text-center h-[400px] flex flex-col items-center justify-center text-sm font-medium">
          <div className="mb-4">
            <svg
              width="60"
              height="60"
              viewBox="0 0 132 146"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M101.556 5.19343C101.556 2.57435 103.679 0.451172 106.298 0.451172C108.917 0.451172 111.04 2.57435 111.04 5.19343V14.9491C111.04 17.5682 108.917 19.6914 106.298 19.6914C103.679 19.6914 101.556 17.5682 101.556 14.9491V5.19343ZM106.298 4.05117C105.667 4.05117 105.156 4.56258 105.156 5.19343V14.9491C105.156 15.58 105.667 16.0914 106.298 16.0914C106.929 16.0914 107.44 15.58 107.44 14.9491V5.19343C107.44 4.56258 106.929 4.05117 106.298 4.05117ZM0 36.1998C0 27.2528 7.25299 19.9998 16.2 19.9998H91.8C100.747 19.9998 108 27.2528 108 36.1998V96.1797C119.323 98.6517 127.8 108.736 127.8 120.8C127.8 134.717 116.518 146 102.6 146C91.1843 146 81.5415 138.409 78.4436 128H16.2C7.25299 128 0 120.747 0 111.8V36.1998ZM77.6552 124.4C77.487 123.224 77.4 122.022 77.4 120.8C77.4 113.749 80.2961 107.374 84.9637 102.8H21.6C15.6353 102.8 10.8 97.9645 10.8 91.9998V41.5998C10.8 35.6351 15.6353 30.7998 21.6 30.7998H86.4C92.3647 30.7998 97.2 35.6351 97.2 41.5998V91.9998C97.2 93.568 96.8658 95.0581 96.2646 96.4028C98.2889 95.8787 100.412 95.5998 102.6 95.5998C103.205 95.5998 103.805 95.6211 104.4 95.6631V36.1998C104.4 29.241 98.7588 23.5998 91.8 23.5998H16.2C9.24121 23.5998 3.6 29.241 3.6 36.1998V111.8C3.6 118.759 9.24121 124.4 16.2 124.4H77.6552ZM21.6 34.3998C17.6236 34.3998 14.4 37.6234 14.4 41.5998V81.8916L28.2438 67.6042C32.4873 63.2247 39.5127 63.2247 43.7562 67.6042L56.0532 80.2953C57.9609 82.2641 61.0412 82.4911 63.2169 80.8231L70.8289 74.9871C74.7056 72.0151 80.0945 72.0151 83.9711 74.9871L93.6 82.3693V41.5998C93.6 37.6234 90.3764 34.3998 86.4 34.3998H21.6ZM73.2301 60.733C73.2301 64.8751 69.8815 68.233 65.7508 68.233C61.6201 68.233 58.2715 64.8751 58.2715 60.733C58.2715 56.5909 61.6201 53.233 65.7508 53.233C69.8815 53.233 73.2301 56.5909 73.2301 60.733ZM111.876 24.7421C111.876 22.123 113.999 19.9998 116.618 19.9998H126.374C128.993 19.9998 131.116 22.123 131.116 24.7421C131.116 27.3611 128.993 29.4843 126.374 29.4843H116.618C113.999 29.4843 111.876 27.3611 111.876 24.7421ZM116.618 23.5998C115.987 23.5998 115.476 24.1112 115.476 24.7421C115.476 25.3729 115.987 25.8843 116.618 25.8843H126.374C127.005 25.8843 127.516 25.3729 127.516 24.7421C127.516 24.1112 127.005 23.5998 126.374 23.5998H116.618ZM81 120.8C81 108.87 90.6706 99.1998 102.6 99.1998C114.529 99.1998 124.2 108.87 124.2 120.8C124.2 132.729 114.529 142.4 102.6 142.4C90.6706 142.4 81 132.729 81 120.8ZM98.1 109.1C98.1 106.615 100.115 104.6 102.6 104.6C105.085 104.6 107.1 106.615 107.1 109.1V119.9C107.1 122.385 105.085 124.4 102.6 124.4C100.115 124.4 98.1 122.385 98.1 119.9V109.1ZM102.6 108.2C102.103 108.2 101.7 108.603 101.7 109.1V119.9C101.7 120.397 102.103 120.8 102.6 120.8C103.097 120.8 103.5 120.397 103.5 119.9V109.1C103.5 108.603 103.097 108.2 102.6 108.2ZM102.6 137C100.115 137 98.1 134.985 98.1 132.5C98.1 130.015 100.115 128 102.6 128C105.085 128 107.1 130.015 107.1 132.5C107.1 134.985 105.085 137 102.6 137ZM101.7 132.5C101.7 132.997 102.103 133.4 102.6 133.4C103.097 133.4 103.5 132.997 103.5 132.5C103.5 132.003 103.097 131.6 102.6 131.6C102.103 131.6 101.7 132.003 101.7 132.5Z"
                fill="rgb(107 114 128)"
              />
            </svg>
          </div>
          <div>
            Unable to display the {props.plotName ? props.plotName : "image"}.
          </div>
          <div>Please refresh the page or re-generate</div>
        </div>
      ) : (
        <>
          {props.showShapLabel && <ShapLabel />}
          <img src={props.src} onError={() => setIsError(true)} />
        </>
      )}
    </>
  );
};
